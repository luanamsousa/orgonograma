<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Organograma Funcional</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f4f6f9;
    }

    h1 {
      color: #0d2b45;
      margin-bottom: 10px;
    }

    #status {
      margin-bottom: 20px;
      font-weight: bold;
    }

    .funcao-bloco {
      background: white;
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 30px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    .funcao-titulo {
      font-size: 18px;
      font-weight: bold;
      color: #0d2b45;
      margin-bottom: 15px;
      border-left: 6px solid #1eb6d6;
      padding-left: 10px;
    }

    .pessoas-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .pessoa-card {
      background: #1eb6d6;
      color: #002b36;
      padding: 10px 14px;
      border-radius: 20px;
      font-weight: bold;
      font-size: 13px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.15);
    }

    @media (max-width: 600px) {
      .pessoa-card {
        font-size: 12px;
      }
    }
  </style>
</head>

<body>

<h1>Organograma Funcional</h1>
<div id="status">Carregando dados...</div>
<div id="organograma"></div>

<script>
  const url = "https://script.google.com/macros/s/AKfycbyigyFcP5TxvuawbFkbdc7H2PyRhITazUHLMn2vcaWyea5wL6b5RXnFlWQC1F-bTnBVbg/exec";

  function carregarDados() {
    fetch(url)
      .then(res => res.json())
      .then(data => {
        document.getElementById("status").innerHTML = "✓ Organograma carregado";
        montarOrganograma(data.hierarchy, data.people);
      })
      .catch(err => {
        document.getElementById("status").innerHTML = "❌ Erro ao carregar dados";
        console.error(err);
      });
  }

  function montarOrganograma(hierarchy, people) {
    const container = document.getElementById("organograma");
    container.innerHTML = "";

    hierarchy.forEach(funcao => {

      const bloco = document.createElement("div");
      bloco.className = "funcao-bloco";

      const titulo = document.createElement("div");
      titulo.className = "funcao-titulo";
      titulo.textContent = funcao.name;

      const grid = document.createElement("div");
      grid.className = "pessoas-grid";

      const pessoasDaFuncao = people.filter(p => p.role === funcao.id);

      if (pessoasDaFuncao.length === 0) {
        const vazio = document.createElement("div");
        vazio.textContent = "Nenhum integrante";
        vazio.style.color = "#777";
        grid.appendChild(vazio);
      } else {
        pessoasDaFuncao.forEach(pessoa => {
          const card = document.createElement("div");
          card.className = "pessoa-card";
          card.textContent = pessoa.name;
          grid.appendChild(card);
        });
      }

      bloco.appendChild(titulo);
      bloco.appendChild(grid);
      container.appendChild(bloco);
    });
  }

  carregarDados();
</script>

</body>
</html>
